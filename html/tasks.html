<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>æ¯é€±ä»»å‹™ - ç¢³ Bee</title>
  <link rel="stylesheet" href="../css/tasks.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body>
  
  <div id="site-nav"></div>

  <div class="wrap">
    <header class="page-header">
      <div>
        <h2>æ¯é€±ä»»å‹™</h2>
        <div class="small">å®Œæˆæ¯é€±æŒ‘æˆ°ï¼Œè³ºå–å¤§é‡ç¢³å¹£ï¼(æ¯é€±ä¸€ 00:00 é‡ç½®)</div>
      </div>
      <div class="stats-card">
        <div class="stats-label">æœ¬é€±å·²ç²çå‹µ</div>
        <div class="stats-value">+<span id="weekly-earnings">0</span> ğŸ’°</div>
      </div>
    </header>

    <div class="card">
      <h4 class="card-title"><i class="fas fa-list-check"></i> æœ¬é€±æŒ‘æˆ°</h4>
      <div id="tasks-container"></div>
    </div>

    <div class="card">
      <h4 class="card-title"><i class="fas fa-history"></i> æ­·å²ç´€éŒ„ & çå‹µ</h4>
      <div id="history-container"></div>
    </div>
  </div>

  <script src="../js/nav.js"></script>
  
  <script>
    // --- 1. ä»»å‹™è³‡æ–™åº« ---
    let tasksData = [
      { id: 't1', icon: 'ğŸšŒ', title: 'é€šå‹¤é”äºº', desc: 'æœ¬é€±æ­ä¹˜å¤§çœ¾é‹è¼¸ 5 æ¬¡', progress: 3, target: 5, reward: 50, status: 0 },
      { id: 't2', icon: 'ğŸ”¥', title: 'å …æŒåˆ°åº•', desc: 'é€£çºŒ 3 å¤©æ­ä¹˜å¤§çœ¾é‹è¼¸', progress: 3, target: 3, reward: 30, status: 1 }, 
      { id: 't3', icon: 'ğŸš²', title: 'ç¶ è‰²é¨å£«', desc: 'é¨ä¹˜ YouBike ç´¯è¨ˆ 10 å…¬é‡Œ', progress: 8.5, target: 10, reward: 40, status: 0 },
      { id: 't4', icon: 'ğŸŒ…', title: 'æ—©é³¥è¡Œå‹•', desc: 'æ—©ä¸Š 8 é»å‰å®Œæˆä¸€æ¬¡æ‰“å¡', progress: 0, target: 1, reward: 20, status: 0 },
      { id: 't5', icon: 'ğŸ¤', title: 'æ¨å»£å¤§ä½¿', desc: 'é‚€è«‹ 1 ä½å¥½å‹åŠ å…¥å¹³å°', progress: 1, target: 1, reward: 100, status: 2 } 
    ];

    let historyData = [
      { date: '2025/12/20', title: 'å®Œæˆæ¯é€±ä»»å‹™ï¼šæ¨å»£å¤§ä½¿', reward: 100 },
      { date: '2025/12/15', title: 'å®Œæˆæ¯é€±ä»»å‹™ï¼šé€šå‹¤é”äºº', reward: 50 }
    ];

    function renderTasks() {
      const container = document.getElementById('tasks-container');
      container.innerHTML = '';
      let weeklyTotal = 0;

      tasksData.forEach(task => {
        let percent = Math.min((task.progress / task.target) * 100, 100);
        let btnHtml = '';

        if (task.status === 2) {
          btnHtml = `<button class="btn-claim" disabled>å·²é ˜å–</button>`;
          weeklyTotal += task.reward;
        } else if (task.progress >= task.target) {
          task.status = 1; 
          btnHtml = `<button class="btn-claim active" onclick="claimReward('${task.id}')">é ˜å– ${task.reward} ğŸ’°</button>`;
        } else {
          btnHtml = `<button class="btn-claim" disabled>${task.progress}/${task.target}</button>`;
        }

        const div = document.createElement('div');
        div.className = `task-item ${task.status === 2 ? 'completed' : ''}`;
        div.innerHTML = `
          <div class="task-icon">${task.icon}</div>
          <div class="task-info">
            <div class="task-header">
              <span class="task-title">${task.title}</span>
              <span class="task-reward">+${task.reward} ç¢³å¹£</span>
            </div>
            <div class="task-desc">${task.desc}</div>
            <div class="progress-bg">
              <div class="progress-bar" style="width: ${percent}%"></div>
            </div>
          </div>
          <div class="task-action">${btnHtml}</div>
        `;
        container.appendChild(div);
      });
      document.getElementById('weekly-earnings').innerText = weeklyTotal;
    }

    function renderHistory() {
      const container = document.getElementById('history-container');
      container.innerHTML = '';
      historyData.forEach(h => {
        const div = document.createElement('div');
        div.className = 'history-item';
        div.innerHTML = `
          <div class="history-date">${h.date}</div>
          <div class="history-detail">${h.title}</div>
          <div class="history-coin">+${h.reward}</div>
        `;
        container.appendChild(div);
      });
    }

    function claimReward(id) {
      const task = tasksData.find(t => t.id === id);
      if (!task) return;
      task.status = 2;
      const today = new Date().toLocaleDateString();
      historyData.unshift({ date: today, title: `å®Œæˆä»»å‹™ï¼š${task.title}`, reward: task.reward });
      alert(`ğŸ‰ æ­å–œï¼ç²å¾— ${task.reward} ç¢³å¹£ï¼`);
      renderTasks();
      renderHistory();
    }

    // åˆå§‹åŒ–åŸ·è¡Œ
    renderTasks();
    renderHistory();
  </script>
</body>
</html>